const header=document.getElementById("header"),hamburger=document.getElementById("hamburger"),navMenu=document.getElementById("navMenu"),navLinks=document.querySelectorAll(".nav-link");let lastScroll=0;function updateHeaderStyle(){const e=window.pageYOffset;e>50?header.classList.add("scrolled"):header.classList.remove("scrolled"),lastScroll=e}header&&updateHeaderStyle(),window.addEventListener("scroll",()=>{updateHeaderStyle()}),hamburger&&hamburger.addEventListener("click",()=>{navMenu.classList.toggle("active"),hamburger.classList.toggle("active");const e=hamburger.querySelectorAll("span");hamburger.classList.contains("active")?(e[0].style.transform="rotate(45deg) translateY(10px)",e[1].style.opacity="0",e[2].style.transform="rotate(-45deg) translateY(-10px)"):(e[0].style.transform="",e[1].style.opacity="1",e[2].style.transform="")}),navLinks.forEach(e=>{e.addEventListener("click",()=>{navMenu.classList.remove("active"),hamburger.classList.remove("active");const e=hamburger.querySelectorAll("span");e[0].style.transform="",e[1].style.opacity="1",e[2].style.transform=""})}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"===t)return;if(this.hasAttribute("data-smart-finder"))return;e.preventDefault();const o=document.querySelector(t);if(o){const e=header.offsetHeight,t=o.offsetTop-e-20;window.scrollTo({top:t,behavior:"smooth"})}})});const faqItems=document.querySelectorAll(".faq-item");faqItems.forEach(e=>{const t=e.querySelector(".faq-question");t&&t.addEventListener("click",()=>{const t=e.closest(".faq-container, .faq-section");t&&t.querySelectorAll(".faq-item").forEach(t=>{t!==e&&t.classList.remove("active")}),e.classList.toggle("active")})});const contactForm=document.getElementById("contactForm");contactForm&&contactForm.addEventListener("submit",async e=>{e.preventDefault();const t=contactForm.querySelector('button[type="submit"]'),o=t.innerHTML;t.innerHTML="‚è≥ Envoi en cours...",t.disabled=!0;const n=new FormData(contactForm);Object.fromEntries(n.entries());try{await new Promise(e=>setTimeout(e,1500)),t.innerHTML="‚úì Message envoy√© !",t.style.background="var(--success-color)",showNotification("‚úì Merci ! Nous vous recontacterons sous 24h.","success"),setTimeout(()=>{contactForm.reset(),t.innerHTML=o,t.style.background="",t.disabled=!1},3e3)}catch(e){t.innerHTML="‚úó Erreur - R√©essayer",t.style.background="var(--error-color)",showNotification("‚úó Erreur lors de l'envoi. Veuillez r√©essayer.","error"),setTimeout(()=>{t.innerHTML=o,t.style.background="",t.disabled=!1},3e3)}});const newsletterForms=document.querySelectorAll(".footer-newsletter-form");function showNotification(e,t="info"){const o=document.createElement("div");o.className="notification",o.style.cssText=`\n        position: fixed;\n        top: 100px;\n        right: 20px;\n        background: ${"success"===t?"var(--success-color)":"error"===t?"var(--error-color)":"var(--primary-color)"};\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: var(--radius-md);\n        box-shadow: var(--shadow-lg);\n        z-index: 10000;\n        animation: slideInRight 0.3s ease;\n        max-width: 350px;\n        font-weight: 500;\n    `,o.textContent=e,document.body.appendChild(o),setTimeout(()=>{o.style.animation="slideOutRight 0.3s ease",setTimeout(()=>{document.body.removeChild(o)},300)},5e3)}newsletterForms.forEach(e=>{e.addEventListener("submit",async t=>{t.preventDefault();const o=e.querySelector('input[type="email"]'),n=e.querySelector("button"),a=(o.value,n.innerHTML);n.innerHTML="‚è≥",n.disabled=!0;try{await new Promise(e=>setTimeout(e,1e3)),n.innerHTML="‚úì",showNotification("‚úì Merci pour votre inscription !","success"),setTimeout(()=>{o.value="",n.innerHTML=a,n.disabled=!1},2e3)}catch(e){n.innerHTML="‚úó",showNotification("‚úó Erreur lors de l'inscription.","error"),setTimeout(()=>{n.innerHTML=a,n.disabled=!1},2e3)}})});const notificationStyles=document.createElement("style");notificationStyles.textContent="\n    @keyframes slideInRight {\n        from {\n            transform: translateX(400px);\n            opacity: 0;\n        }\n        to {\n            transform: translateX(0);\n            opacity: 1;\n        }\n    }\n    \n    @keyframes slideOutRight {\n        from {\n            transform: translateX(0);\n            opacity: 1;\n        }\n        to {\n            transform: translateX(400px);\n            opacity: 0;\n        }\n    }\n",document.head.appendChild(notificationStyles);const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"},observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)",observer.unobserve(e.target))})},observerOptions),animatedElements=document.querySelectorAll(".value-card, .service-block, .pricing-card, .testimonial-card, .blog-card");function animateCounter(e,t,o=2e3){const n=t/(o/16);let a=0;const s=setInterval(()=>{a+=n,a>=t?(e.textContent=formatNumber(t),clearInterval(s)):e.textContent=formatNumber(Math.floor(a))},16)}function formatNumber(e){return e>=1e3?(e/1e3).toFixed(1)+"K":e}animatedElements.forEach(e=>{e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease",observer.observe(e)});const heroStats=document.querySelectorAll(".hero-stats .stat-number");let statsAnimated=!1;const statsObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting&&!statsAnimated){statsAnimated=!0;e.target.querySelectorAll(".stat-number").forEach(e=>{const t=e.textContent,o=parseInt(t.replace(/[^0-9]/g,""));isNaN(o)||(e.textContent="0",setTimeout(()=>{animateCounter(e,o)},300))}),statsObserver.unobserve(e.target)}})},{threshold:.5}),heroStatsContainer=document.querySelector(".hero-stats");heroStatsContainer&&statsObserver.observe(heroStatsContainer);const fomoMessages=[{icon:"üçΩÔ∏è",name:"Marc de Lyon",action:"Bundle Restaurant (3 apps en 1h)",time:"2 min"},{icon:"üõí",name:"Sophie de Paris",action:"E-Commerce Suite (+28% conversions)",time:"5 min"},{icon:"üì¶",name:"Emma de Toulouse",action:"All-in-One (5 apps install√©es)",time:"12 min"},{icon:"‚ö°",name:"Alex de Bordeaux",action:"a test√© FOMOWidget (gratuit 14j)",time:"18 min"},{icon:"üéì",name:"Laura de Marseille",action:"SmartSchool live en 2h chrono",time:"25 min"},{icon:"üìà",name:"Thomas de Nantes",action:"AutoPost actif (3 r√©seaux sociaux)",time:"32 min"}];let fomoIndex=0;function showFomoNotification(){if(window.innerWidth<768||window.pageYOffset<500)return;const e=fomoMessages[fomoIndex];fomoIndex=(fomoIndex+1)%fomoMessages.length;const t=document.createElement("div");t.className="fomo-popup",t.style.cssText="\n        position: fixed;\n        bottom: 30px;\n        left: 30px;\n        background: white;\n        padding: 1rem 1.5rem;\n        border-radius: var(--radius-md);\n        box-shadow: var(--shadow-xl);\n        z-index: 9999;\n        display: flex;\n        align-items: center;\n        gap: 1rem;\n        max-width: 350px;\n        animation: slideInLeft 0.5s ease;\n        cursor: pointer;\n    ",t.innerHTML=`\n        <div style="font-size: 2rem;">${e.icon}</div>\n        <div style="flex: 1;">\n            <strong style="display: block; margin-bottom: 0.2rem; color: var(--text-primary);">${e.name}</strong>\n            <p style="margin: 0; font-size: 0.9rem; color: var(--text-secondary);">${e.action}</p>\n            <span style="font-size: 0.75rem; color: var(--text-light);">Il y a ${e.time}</span>\n        </div>\n        <button style="background: none; border: none; cursor: pointer; font-size: 1.2rem; color: var(--text-light);">√ó</button>\n    `,document.body.appendChild(t);t.querySelector("button").addEventListener("click",e=>{e.stopPropagation(),removeFomo(t)}),t.addEventListener("click",()=>{removeFomo(t)}),setTimeout(()=>{document.body.contains(t)&&removeFomo(t)},8e3)}function removeFomo(e){e.style.animation="slideOutLeft 0.3s ease",setTimeout(()=>{document.body.contains(e)&&document.body.removeChild(e)},300)}const fomoStyles=document.createElement("style");let fomoInterval;function startFomoNotifications(){setTimeout(()=>{showFomoNotification(),fomoInterval=setInterval(()=>{showFomoNotification()},1e4*Math.random()+15e3)},1e4)}fomoStyles.textContent="\n    @keyframes slideInLeft {\n        from {\n            transform: translateX(-400px);\n            opacity: 0;\n        }\n        to {\n            transform: translateX(0);\n            opacity: 1;\n        }\n    }\n    \n    @keyframes slideOutLeft {\n        from {\n            transform: translateX(0);\n            opacity: 1;\n        }\n        to {\n            transform: translateX(-400px);\n            opacity: 0;\n        }\n    }\n    \n    .fomo-popup:hover {\n        transform: translateY(-5px);\n        transition: transform 0.3s ease;\n    }\n",document.head.appendChild(fomoStyles),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",startFomoNotifications):startFomoNotifications();const lazyImages=document.querySelectorAll("img[data-src]"),imageObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target;t.src=t.dataset.src,t.removeAttribute("data-src"),imageObserver.unobserve(t)}})});function debounce(e,t=10){let o;return function(...n){clearTimeout(o),o=setTimeout(()=>{clearTimeout(o),e(...n)},t)}}function throttle(e,t=16){let o;return function(...n){o||(e.apply(this,n),o=!0,setTimeout(()=>o=!1,t))}}function trackEvent(e,t,o){console.log("Track Event:",{category:e,action:t,label:o})}lazyImages.forEach(e=>imageObserver.observe(e)),document.querySelectorAll(".btn-primary").forEach(e=>{e.addEventListener("click",()=>{trackEvent("CTA","Click",e.textContent.trim())})});const appObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.id;t&&trackEvent("App","View",t),appObserver.unobserve(e.target)}})},{threshold:.5});function trapFocus(e){const t=e.querySelectorAll('a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])'),o=t[0],n=t[t.length-1];e.addEventListener("keydown",e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===o&&(e.preventDefault(),n.focus()):document.activeElement===n&&(e.preventDefault(),o.focus()))})}document.querySelectorAll(".app-card[id]").forEach(e=>{appObserver.observe(e)}),navMenu&&trapFocus(navMenu),document.addEventListener("keydown",e=>{!e.target.classList.contains("faq-question")||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.target.click())});const calculateBtn=document.getElementById("calculate-roi"),calculatorResults=document.getElementById("calculator-results");function updateCountdown(){const e=new Date;e.setDate(e.getDate()+7);const t=e-new Date;if(t>0){const e=Math.floor(t/864e5),o=Math.floor(t%864e5/36e5),n=Math.floor(t%36e5/6e4),a=document.getElementById("countdown-timer");a&&(a.textContent=`${e}j ${o}h ${n}min`)}}calculateBtn&&calculateBtn.addEventListener("click",()=>{const e=parseFloat(document.getElementById("monthly-revenue").value)||0,t=document.getElementById("conversion-rate").value,o=document.getElementById("time-spent").value;if(0===e)return void alert("Veuillez entrer le nombre d'apps n√©cessaires");let n,a,s;"simple"===t?(n=8e3+3e3*e,a=2+.5*e):"medium"===t?(n=15e3+5e3*e,a=3+1*e):(n=25e3+7e3*e,a=6+1.5*e),s=Math.round(197*e);const r=n-3*s,l="urgent"===o?"1-2 jours":"normal"===o?"1 semaine":"2-4 semaines";document.getElementById("potential-gain").textContent=`‚Ç¨${r.toLocaleString()}`,document.getElementById("time-saved").textContent=`${Math.round(a)} mois`,document.getElementById("roi-value").textContent=l,document.getElementById("extra-revenue").textContent=n.toLocaleString(),document.getElementById("time-value").textContent=Math.round(a),document.getElementById("net-gain").textContent=s.toLocaleString(),calculatorResults.style.display="block",calculatorResults.scrollIntoView({behavior:"smooth",block:"nearest"}),trackEvent("Calculator","Calculated",`Apps: ${e}, Type: ${t}`)}),document.getElementById("countdown-timer")&&(updateCountdown(),setInterval(updateCountdown,6e4));const closeBanner=document.getElementById("close-banner");if(closeBanner&&closeBanner.addEventListener("click",()=>{document.getElementById("launch-banner").style.display="none",localStorage.setItem("bannerClosed","true")}),"true"===localStorage.getItem("bannerClosed")){const e=document.getElementById("launch-banner");e&&(e.style.display="none")}console.log("%c‚öì NicolasVirin.com","font-size: 24px; font-weight: bold; color: #0066FF;"),console.log("%cD√©v / Apps ? Contactez-moi.","font-size: 14px; color: #4A5568;"),console.log("%cnicolas@nicolasvirin.com","font-size: 12px; color: #718096;");const cookieBanner=document.getElementById("cookieBanner"),acceptCookies=document.getElementById("acceptCookies"),refuseCookies=document.getElementById("refuseCookies");function checkCookieConsent(){localStorage.getItem("cookieConsent")||setTimeout(()=>{cookieBanner&&cookieBanner.classList.add("show")},2e3)}acceptCookies&&acceptCookies.addEventListener("click",()=>{localStorage.setItem("cookieConsent","accepted"),cookieBanner.classList.remove("show")}),refuseCookies&&refuseCookies.addEventListener("click",()=>{localStorage.setItem("cookieConsent","refused"),cookieBanner.classList.remove("show")}),document.addEventListener("DOMContentLoaded",()=>{console.log("‚úì Captainsimple loaded successfully"),document.body.classList.add("loaded"),checkCookieConsent()});const mobileCtaFixed=document.getElementById("mobileCtaFixed");let lastScrollTop=0,scrollThreshold=200,isScrollingUp=!1;mobileCtaFixed&&window.addEventListener("scroll",()=>{const e=window.pageYOffset||document.documentElement.scrollTop,t=window.innerHeight,o=document.documentElement.scrollHeight;isScrollingUp=e<lastScrollTop,e>scrollThreshold&&isScrollingUp&&e>50&&e+t<o-100?mobileCtaFixed.classList.add("show"):(e<=scrollThreshold||e+t>=o-50||!isScrollingUp)&&mobileCtaFixed.classList.remove("show"),lastScrollTop=e<=0?0:e},{passive:!0});const popularAppsConfig=[{name:"SmartSchool Vitrine Ind√©pendant",category:"education"},{name:"SmartSchool Vitrine Centre",category:"education"},{name:"SmartSchool LMS",category:"education"},{name:"SmartSchool App LMS",category:"education"}];function initPopularApps(){const e=document.getElementById("popularAppsGrid");if(!e)return void console.warn("popularAppsGrid not found");e.innerHTML="";const t=document.querySelectorAll(".app-card");0!==t.length?(console.log(`Found ${t.length} app cards`),console.log("Looking for popular apps:",popularAppsConfig.map(e=>e.name)),popularAppsConfig.forEach(o=>{let n=!1;if(t.forEach(t=>{const a=t.querySelector(".app-name");if(!a)return;if(a.textContent.trim()===o.name){n=!0;const a=t.cloneNode(!0);return a.classList.add("popular-app-card"),a.classList.remove("app-card"),e.appendChild(a),void console.log(`‚úÖ Added ${o.name} to popular apps`)}}),!n){console.warn(`‚ö†Ô∏è App "${o.name}" not found in catalog`);const e=Array.from(t).map(e=>{const t=e.querySelector(".app-name");return t?t.textContent.trim():"No name"}).filter(e=>e.toLowerCase().includes("smartschool"));e.length>0&&console.log("Found SmartSchool apps:",e)}})):console.warn("No app cards found")}const showAllBtn=document.getElementById("showAllAppsBtn"),fullCatalog=document.getElementById("fullCatalog"),catalogFilters=document.getElementById("catalogFilters"),popularSection=document.getElementById("popularApps");function initCatalog(){initPopularApps();const e=document.getElementById("fullCatalog");e&&(e.style.display="none");const t=document.getElementById("popularApps");t&&(t.style.display="block")}function updateResultsCounter(e){const t=document.getElementById("counterNumber");if(!t)return;let o=0;if("popular"===e){const e=document.querySelectorAll(".popular-app-card");o=e.length}else if("all"===e){const e=document.querySelectorAll(".app-card:not(.popular-app-card)");o=e.length}else{document.querySelectorAll(".category-block[data-category]:not(.hidden)").forEach(e=>{const t=e.querySelectorAll(".app-card");o+=t.length})}(parseInt(t.textContent)||0)!==o?(t.style.opacity="0.5",setTimeout(()=>{t.textContent=o,t.style.opacity="1"},150)):t.textContent=o}if(showAllBtn&&fullCatalog&&catalogFilters&&showAllBtn.addEventListener("click",function(){const e=catalogFilters.querySelector('.filter-btn[data-category="all"]');e&&e.click()}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{initCatalog(),initPopularApps()},200)}):setTimeout(()=>{initCatalog(),initPopularApps()},200),catalogFilters){const e=catalogFilters.querySelectorAll(".filter-btn"),t=document.querySelectorAll(".category-block[data-category]"),o=document.getElementById("popularApps"),n=document.getElementById("fullCatalog");e.forEach(a=>{a.addEventListener("click",()=>{const s=a.getAttribute("data-category");if(e.forEach(e=>e.classList.remove("active")),a.classList.add("active"),"popular"===s)o&&(o.style.display="block"),n&&(n.style.display="none"),updateResultsCounter("popular"),setTimeout(()=>{o&&o.scrollIntoView({behavior:"smooth",block:"start"})},100);else if("all"===s)o&&(o.style.display="none"),n&&(n.style.display="block"),setTimeout(()=>{n&&(n.style.opacity="1",n.style.transform="translateY(0)")},50),t.forEach(e=>{e.classList.remove("hidden"),e.style.display="",setTimeout(()=>{e.classList.add("fade-in"),e.classList.remove("fade-out")},10)}),setTimeout(()=>{updateResultsCounter("all")},350),setTimeout(()=>{const e=t[0];if(e){const t=e.querySelector(".app-card");if(t){const e=80,o=t.getBoundingClientRect().top+window.pageYOffset-e-20;window.scrollTo({top:o,behavior:"smooth"})}else{const e=document.getElementById("apps-catalog");if(e){const t=e.offsetTop-100;window.scrollTo({top:t,behavior:"smooth"})}}}},400);else{o&&(o.style.display="none"),n&&(n.style.display="block"),setTimeout(()=>{n&&(n.style.opacity="1",n.style.transform="translateY(0)")},50);let e=null;t.forEach(t=>{t.getAttribute("data-category")===s?(t.classList.remove("hidden"),t.style.display="",e||(e=t),setTimeout(()=>{t.classList.add("fade-in"),t.classList.remove("fade-out")},10)):(t.classList.add("fade-out"),t.classList.remove("fade-in"),setTimeout(()=>{t.classList.add("hidden"),t.style.display="none"},300))}),setTimeout(()=>{updateResultsCounter(s)},350),setTimeout(()=>{if(e){const t=e.querySelector(".app-card");if(t){const e=80,o=t.getBoundingClientRect().top+window.pageYOffset-e-20;window.scrollTo({top:o,behavior:"smooth"})}else{const t=e.getBoundingClientRect().top+window.pageYOffset-headerHeight-20;window.scrollTo({top:t,behavior:"smooth"})}}else{const e=document.getElementById("apps-catalog");if(e){const t=e.offsetTop-100;window.scrollTo({top:t,behavior:"smooth"})}}},400)}})}),updateResultsCounter("popular")}